<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../fc-grid/data-manager.html">
<link rel="import" href="../fc-grid/fc-grid-input-behaviors/fc-api-inputs-grid-navigation-behavior.html">
<link rel="import" href="../fc-grid/fc-grid-input-behaviors/fc-grids-from-api-inputs-behavior.html">
<link rel="import" href="../fc-grid/fc-grid-input-behaviors/fc-api-inputs-from-grids-behavior.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation-behavior.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/firebase-element/firebase-collection.html">
<link rel="import" href="../fc-grid/fc-iss-input.html">
<link rel="import" href="../fc-grid/fc-ddr-card.html">
<link rel="import" href="../fc-grid/fc-grid-style-behavior.html">

<link rel="import" href="../src/fc-grid.html">


<link rel="import" href="fc-inquiry.html">
<link rel="import" href="fc-tabbed-card.html">
<link rel="import" href="fc-call-list-view.html">
<link rel="import" href="fc-call-item.html">
<link rel="import" href="FC_frontpage_logo.png">
<link rel="import" href="fc-call-center-form-one.html">
<link rel="import" href="fc-call-center-form.html">
<!-- <link rel="import" href="fc-calendar-behavior-beta-prime.html">
<link rel="import" href="fc-profile-class.html"> -->
<link rel="import" href="fc-tabbed-card-plus.html">
<link rel="import" href="FC_frontpage_logo.png">
<dom-module id="fc-call-center-dialog">

<template>
<style>
:host{
      background: white;
      padding: 0px 23px 4px 28px;
      position: static;
      opacity: 1;
      @apply(--horizontal-layout);
      @apply(--layout-flex);
      }
     
    .headerLeft{
      height: 42px; width: 42px; color: white; float: left;top: 5px;
    }
    .headerRight{
      height: 42px; width: 42px; color: white; float: right;top: 5px;
      }
      .intakeForm{
      	border: 1px #efefef solid;
      	margin: 12px 0px;
      }
     
		paper-button{
		 	 width: 50%;
		 	 min-width: 147px;
		 	 font-weight: 600; 	  
		 	 font-size: 14px;
		 	 text-align: center;
		 	 white-space: nowrap;
		 	 max-height: 36px;
		 	 @apply(--layout-nowrap);
		 	 background: white;
		 	 border: #efefef 1px solid;
		 }
		 paper-button.green{
		 	color: green; 
		 	border: 2px solid green;
		}
    fc-ddr-card{
      min-width: 360px;
      min-height: 80px;
      max-height: 600px;
      max-width: 580px;
    }
		paper-button.darkblue{
			color: #009;
			border: 2px solid #009;
		}
		paper-button.red{
			color: red;
			border: 2px solid red;
		}
		paper-button.orange{
			color: orange;
			border: 2px solid orange;
		}
		paper-button:hover, paper-button:active{
			box-shadow: 2px 4px 7px 2px; 

		} 
		paper-button.darkblue:hover, paper-button.darkblue:active{
			box-shadow: 2px 4px 7px 2px gold; 

		} 
		.buttonRow{
			@apply(--layout-flex);
			@apply(--layout-horizontal);
			padding: 2px;
		}

.footerclass{
	height: 32px;
	padding: 14px;
	color: white;
	background: #03A9F4;
	font-weight: 600;
	text-align: center;
	font-size: 11px;
}
.slides{overflow: hidden; overflow-y: scroll;}

.one{
	font-family: merriweather; 
	font-weight: 600;
	color: #080808;
	font-size: 14px;

	white-space: nowrap;
	display: inline-block;
}
      paper-card{
        width: 100%;
        --paper-card-header-image-text:{color:#009; position: absolute; right: 32px; top: 45px;}
        --paper-card-header-image: {width: 165px; height: 120px; margin: 12px 16px 16px 16px;};
        --paper-card-header:{height: 95px; border-bottom: double 6px green;}
  
    }
  
      neon-animated-pages {
        @apply(--layout-flex);
        @apply(--layout-horizontal)
        margin: 12px 0px 12px 0px
        padding: 12px;
        background: white;
        @apply(--layout-self-stretch);
        min-height: 1080px;
        height: 100%;
      }
      neon-animatable {
        color: white;
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        @apply(--paper-font-display3);
        margin: 0px;
        padding: 0px;
      }
    
    .subheading {
    font-size: 14px;
    color: brown;
    font-family: times;
 		float: right;
 		margin: 0px 12px;
    padding: 8px;
    }
    paper-radio-button{
    		font-size: 16px;
    		font-weight: 600;
    		size: var(--paper-radio-size, 18px);
    		 /*  --paper-radio-button-label-color: var(--my-blue-009, #000099);*/
    		   --paper-radio-button-checked-color: var(--paper-green-900);


    }
    .card-actions{
    	padding: 16px 8px;
    }
    label.returningCaller{
    	color: black;
    	font-size: 16px;
    /*	font-style: italic;*/
    	font-weight: 700;
    }
    paper-radio-group.tallbox{
    	@apply(--layout-vertical);
    	 --paper-radio-group-padding: var(--too-much-padding, 6px);

    }
    
    p{
    	text-indent: 36px;
    	font-size: 14px;
    	font-weight: 600;
    		}
  .setHeight {
    min-height: 68px;
    max-height: 980px;

    max-width: 485px;
    min-width: 380px;
    margin: 4px;
    padding: 4px;
  }
  
  .timestamp{
  	font-weight: 600;
  	font-size: 16px;
  	padding: 8px;
  	float: left;

  }
  .dropbtn:hover, .dropbtn:focus{
		    background-color: #3e8e41;
		}
		/* The container <div> - needed to position the dropdown content */
		.dropdown {
		    position: relative;
		    display: inline-block;
		}
		/* Dropdown Content (Hidden by Default) */
		.dropdown-content {
		    display: none;
		    position: absolute;
		    background-color: #f9f9f9;
		    min-width: 160px;
		    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
		}
		/* Links inside the dropdown */
		.dropdown-content a {
		    color: black;
		    padding: 12px 16px;
		    text-decoration: none;
		    display: block;
		}
		.check{
			font-size:26px;
			color: green;
			position: absolute;
			left: 5px;
		}
		.instruction{
			color:#009;
			font-weight:700;
		}
		.radioGroupBlock{
			padding: 12px;



		},
		.importantNote{
				color: black;
				font-weight: 600;
				padding: 8px;
				margin: 4px;
				margin-bottom: 26px;

		},
		.detailPads{
				margin:12px;
				margin-top: 24px;

		}

		.show {display:block; z-index: 45; right: 0;}
  @media(max-width: 687px){
  	#content{
  		@apply(--layout-vertical);
  		@apply(--layout-center);
  	}
  	/*add more here*/
  }
  </style>
<form is="iron-form" id="callIntakeForm" method="get" action="/">
  <fc-ddr-card id="focusedCallInterface"  waterfall header-set-height="125px" head-class="darkBlue" header-title="{{chosen}}" class="vertical layout flex nowrap self-stretch" on-tap="_tapHandler" style="padding-right:2px; margin: 4px 0px 4px 0px; min-width: 100%!important;">


  <div class="dropdown headerLeft horizontal layout">
   <span btn="leftClick" style="position: absolute; left: -30px; top: 8px; font-size: 18px; cursor: pointer;">&#8678;</span>
     <span on-tap="selectApi" style="cursor: pointer;">&#9994;</span>

  </div>

     <div class="dropdown headerRight">
          <span btn="rightClick" style="position: absolute; right: -30px; top: 8px; font-size: 18px; cursor: pointer;">&#8680;</span>
          <span on-tap="selectApi" style="cursor: pointer; font-size:28px;">&#9995;</span>

    </div>
 	<div class="flex layout horizontal center-justified">
 		<section id="hanger" ></section>
    
        <neon-animated-pages id="pages" selected="[[selected]]" entry-animation="[[entryAnimation]]" exit-animation="[[exitAnimation]]">
            <div id="container1">
                <fc-call-center-form-one page-index="{{selected}}" inquiry="{{inquiry}}"  id="childOne" current-height="{{childHeight}}">
                        <span class="pageTotal">{{shadowIndex}}</span>
                        <section class="next" style="color: brown; font-size:  20px; float: right; text-align: right;" btn="rightClick">NEXT PAGE &#10148</section>
                </fc-call-center-form-one>
            </div>
            <template is="dom-repeat" items="{{selectedApi}}">
                <div>
                    <fc-call-center-form value-object="{{valueObject}}" inquiry="{{inquiry}}" input-array="{{item}}" current-height="{{siblingHeight}}" page-number="{{computePageNumber(selected)}}" item-object="{{item}}" >
                        <span class="pageTotal" on-tap="openCollapse">{{_computePageTotal(selectedApi, index)}}
                        </span>  <span class="pageTotal">{{shadowIndex}}</span>
                        <section class="next" style="color: brown; padding: 12px 8px; font-size: 20px; float: right; text-align: right;" btn="rightClick">NEXT PAGE &#10148</section>
                        
                        <section class="horizontal layout flex buttons"><paper-button class="flex-1" btn="leftClick">back</paper-button>
                        <paper-button class="flex-1" id="one" btn="rightClick">CONTINUE</paper-button>
                        </section>
                              <paper-button class="darkblue" on-tap="submitHandler">Submit</paper-button>
                    </fc-call-center-form>
                </div>
            </template>

        </neon-animated-pages>
    </fc-ddr-card>
     </form>
   
    
</template>
<script>
FcCallCenterDialog=Polymer({
	is:"fc-call-center-dialog",
		 behaviors:[Polymer.NeonAnimatableBehavior,
                Polymer.NeonAnimationBehavior,
                Polymer.NeonAnimationRunnerBehavior,
                FCBehaviors.FcCalendarBehaviorPrime,
                FCBehaviors.FcGridStyleBehavior, 
                FCBehaviors.FcGridsFromApiInputsBehavior,
                FCBehaviors.FocusedDataManagerBehavior,
                FCBehaviors.FcGridsFromApiInputsBehavior,
                FCBehaviors.FcApiInputsGridNavigationBehavior
                ],
          
        listeners: {"onload":"doStuffOnLoad",
                        },
        observers:['observerForSearch(isSearchRequired.isPreviousCaller, isSearchRequired.callerRole)'],
    properties: {

      entryAnimation: {
          type: String,
          value: function(){ return "";},
          notify: true
        },
        shadowIndex:{
            type: String,
            notify: true
        },
        exitAnimation:{
            type: String,
            value: function(){return "";},
            notify: true
        },
 
    valueObject:{
      type: Object, 
      notify: true,
      observer:"observeValueObject",
    },
 
    inquiry:{
      type: Object,
      value:function(){ var obj={
                                 "isPreviousCaller": false,
                                  "isCurrentClient":undefined,
                                  "callerType": "",
                                  "callerRole": "",
                                  "callerFirstName": "",
                                  "callerLastName": "",
                                  "callerTelephone": "",
                                  "inquirerFcid":"",
                                  "relatedStudent": "",
                                "date":"",
                                "time":"",
                                "message": "",
                                 "request": "",
                                "handler": "",
                                "isClosed": ""
                              };
                      return obj;
                    },
      notify: true,
    },
   
    selectedtwo:{
      type: Number, 
      value: 0, 
      notify: true,
    },
  
    childHeight:{
        type: String,
        notify: true,
    },
    siblingHeight:{
        type: String,
        computed: "_computeSiblingHeight(childHeight)",
        notify: true,
    },
    isSearchRequired:{
      type: Object, 
      //observer:"observeIsSearchRequired",
      notify: true,
    },

    pageTotal:{
          type: Number,
          notify: true
        },
    selected: {
          type: Number,
          value: function(){return 0;},
          notify: true
        },
    inputArraysAb:{
        type: Array,
        value:function(){return[];},
        notify: true
    },
  
    currentPage:{
      type: Number,
      computed:"computePageNumber(selected)",
      notify: true
    },
    isFormSubmitted:{
        type: Boolean,
        value: false,
        notify: true
      },
   
  },//end of properties
		

    observeValueObject(nv, ov)
    {
      if(nv)
      {
        console.log(nv, ov);
          if(nv.fcProfile!=undefined)
          {
            var count =this.selectedApi.length;
            console.log(count);
            for(var i=0;i<count;i++)
            {
              var pageInputArray=this.selectedApi[i];
              console.log(pageInputArray);
              var inputSetCount=pageInputArray.length;
              console.log(inputSetCount);
              for(var j=0; j<inputSetCount;j++)
              {
                var inputOfSet=pageInputArray[j];
                console.log(inputOfSet);
                console.log(nv.fcProfile[inputOfSet.nameA], nv.fcProfile[inputOfSet.nameB]);
                if(nv.fcProfile[inputOfSet.nameA]!=undefined){this.set(["selectedApi",i,j,"valueA"], nv.fcProfile[inputOfSet.nameA]); }
                if(nv.fcProfile[inputOfSet.nameB]!=undefined){this.set(["selectedApi",i, j,"valueB"], nv.fcProfile[inputOfSet.nameB]);console.log(this.selectedApi[i][j].valueA, this.selectedApi[i][j].valueB);}
              }
            }
          }
      } 
    }, 
   
    doStuffOnLoad(e){
        this.async(function(){var ht=window.getComputedStyle(this.$.container1, null).getPropertyValue("height"); var wt=window.getComputedStyle(this.$.container1, null).getPropertyValue("width");console.log(ht, wt);this.style.width="480px"; this.style.height="720px";}, 4400);
        //console.log(window.getComputedStyle(this.$.container1, null).getPropertyValue("height"), e);
    },
  _computeSiblingHeight(childHeight){
    //console.log(childHeight, childHeight);
    return childHeight;

  },
  
  ready(){

  },
  attached(){
    var childHt= this.$.container1;
    this.root.addEventListener('dom-change', function() { var ht=window.getComputedStyle(childHt,null).getPropertyValue("height");
      //console.log('ht', ht);
    }, this);
    this.async(this.openDdr, 300);
    this.doStuffOnLoad();

    this.async(this.initializeApiArrays, 300);
  
  },

   submitHandler(event){
      if(this.arrayIndex===this.tagIndex){this.set("sameThing", true);}
        this.set("formSubmitOne", true);
          var formResults = this.$.callIntakeForm.serialize();
            var d = new Date();
            var n = -d.getTime();
            var readableTime=new Date().toLocaleString();
            this.submittedInputs={};
            this.gridMakerFunction(this.apiChoices[this.selectedApiIndex].apiName);
              this.wipeCleanInputs();
                // var objectTostore={"gridName": gridname, "api":"whateverTheInterfaceSays", "currentrow": Number};
},
wipeCleanInputs(){this.set("counter", 0); this.initializeHelper();this.set("student",{});},

computePageNumber(selected){ return this.selected+1;},

  _computePageTotal(selectedApi, index){
     var pageTotal=(this.selectedApi.length+1);
     console.log(this.intakeInputs);
     this.set("pageTotal", pageTotal);
     this.set("shadowIndex", pageTotal);


},


   observeChangeB(event, value, name){
   // console.log(event, value, name);
     this.set(["student",name], value);
     console.log(this.student[name], this.student);

  },

observeChangeA(event, value, name){
    //console.log(event, value, name);
    this.set(["student",name], value);
    console.log(this.student[name], this.student);

  },


	_tapHandler(e){
		var targ=e.target;
		while(!targ.attributes.btn && targ.nodeName!=="FC-DDR-CARD")
		{
			targ=targ.parentElement;
		}
		if(targ.attributes.btn){
		this[targ.attributes.btn.value](e);
	   }
	},
	openDdr(){
		this.$.focusedCallInterface.falseClose();
		this.$.focusedCallInterface.falseClose();
	},
   _computePageNumber(index){
    // console.log(index); 
    var retVal = parseInt(index)+2;
  },
	

    
       rightClick: function() {
        this.entryAnimation = 'slide-from-left-animation';
        this.exitAnimation = 'slide-right-animation';
        
       this.selected = (this.selected === (this.selectedApi.length))? 0 : (this.selected + 1);
       
      },
      leftClick: function() {
        this.entryAnimation = 'slide-from-right-animation';
        this.exitAnimation = 'slide-left-animation';
       this.selected = this.selected === 0 ?(this.selectedApi.length-1): (this.selected - 1);
         
      },
      observerForSearch(isPreviousCaller, callerRole){
        if(isPreviousCaller===true){
             if("2".match(callerRole)){this.leftClick();this.leftClick();}
                  else{this.leftClick();}
        }
      },

_computeTimeStampUseful: function(timeStamp, callLogFormOneObject){
    var d = new Date();
    var n = -d.getTime();
    console.log(n);
    return n;

},
});

</script>
</dom-module>


        -->