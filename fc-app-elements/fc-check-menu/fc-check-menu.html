
<!-- <link rel="import" href="../../fc-call-center/fc-course-calendar-creation-behavior.html">
<link rel="import" href="../../fc-call-center/fc-calendar-list-widget-behavior.html">
<link rel="import" href="../../fc-call-center/fc-calendar-behavior-beta-prime.html"> -->
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../fc-grid/data-manager.html">
<dom-module id="fc-check-menu">
<template id="fc-check-menu">
<style>
    paper-item{
        position: static;
        padding: 4px 4px 4px 0px; 
        margin: 4px;
        font-size: 12px; 
        font-weight: 300; 
        font-family: merriweather; 
        color: #009;
        margin-top: 3px; 
        min-width: 200px; 
        text-align: left;
        max-width: 480px;
        background: white;

       --paper-item-focused-before:{background: white;}
        @apply(--paper-item-focused-before); 
    }
        
     paper-item.dropdown{border-bottom: silver 1px solid; margin: 0px auto; padding: 0px 4px 0px 4px; white-space: nowrap; height: 46px;};
      paper-item.tools{ border-bottom: silver 1px solid; display: flex; width: 100%;}
    paper-item:focus{background: orange; outline: 0px dashed white;};
     paper-item.tools:focus{background: aliceblue; outline: 0px dashed white;}
   @apply(--paper-item);
  
        paper-item-body{padding-left:4px;}
        paper-item-body.tools{width: 100%; @apply(--layout-flex);}

      textarea:focused{outline: 0px white solid;}
      textarea{border-bottom: 2px solid green; font-size: 1.5em; font-family: merriweather; font-weight: 600;}
      details:focus{outline: 0px white solid;}
      summary{outline:0px;padding-left: 8px;}
    section{
            padding: 0px 4px 0px 4px; 
        text-align: left;
        font-size: 14px;
        text-overflow: clip;
  /*      text-overflow: ellipsis;
        text-overflow: "â€¦";*/

    }
    paper-listbox.tools{ 
        min-width: 360px;
        max-width: 100%;
        max-height: 43vh;
        border: red 13px ridge;
           overflow-y: scroll;
        /*add here a media query for smaller phones*/

     }
    section.label.tools{color: red;}
    .selectColor{
        border: 1px green solid;
    }
    
    .checkHolder{
        cursor: pointer; 
         padding: 14px 4px 14px 4px; 
        margin: 8px 5px 12px 0px; 
        text-align: left;
        font-size: 1.4em; 
        color: green;
        @apply(--layout-vertical);
        @apply(--layout-start-justified);
        
    }

    .label.surveyPage{
        color: #005c00;
        font-size: 1.4em;
       text-decoration-style:underline;
       font-weight: 600;
    }
    .label.dropdown{
           color: #005c00;
        font-size: 1.15em;
        font-weight: 300;
       text-decoration-style:underline;
    }
    .dropdown{
        color: #009;
        font-size: .9em;
        font-weight: 300;

    }

 .checkMinus.dropdown{
        color: brown;
        font-size: 1.6em;
        cursor: pointer;
        margin-right: -12px;
        margin-left: 0px;
        padding-left: 0px;
    }
    .check{
  
        font-size: 9px;
        cursor: pointer;
    }

    .check.surveyPage{

        font-size: 1em;  
    }
    .check.dropdown{
        font-size: 9px
    }
    .checkMinus{
        color: brown;
        font-size: 2.2em;
        cursor: pointer;

    }
    .checkmark{
        padding: 3px 4px 14px 4px; 
        margin: 4px -8px 12px 0px; 
        text-align: left;
        font-size: 1.4em; 
        color: green;

    }
    .padded{
    padding: 16% 10%;
    margin: 12px;

    }

    .pad{padding: 5%; max-width: 610px;
    width: 510px;
    min-width: 300px;}

</style>
<div class="layout horizontal flex self-stretch justified wrap pad" hidden$="{{!inputTwoShow}}" >
<fc-iss-input class="left" hidden$="{{!inputOneShow}}" class="padded" iss-name="firstName" name="firstName" iss-label="Caller First Name"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.parent1FirstName}}">
    </fc-iss-input> 
    <fc-iss-input class="right" hidden$="{{!inputTwoShow}}" class="padded" iss-name="lastName" name="lastName" iss-label="Caller Last Name"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.parent1LastName}}">
    </fc-iss-input>
    </div>

<div class="layout horizontal flex self-stretch justified wrap pad" hidden$="{{!inputTwoShow}}" >
<fc-iss-input class="left" hidden$="{{!inputOneShow}}" iss-class="" class="padded" iss-name="callerTelephone" name="callerTelephone" iss-label="Caller Telephone"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.parent1Telephone}}">
    </fc-iss-input> 
    <fc-iss-input class="right" hidden$="{{!inputTwoShow}}" class="padded"iss-name="callerEmail" name="callerEmail" iss-label="Caller Email"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.parent1Email}}">
    </fc-iss-input>
    </div>
    <div class="layout horizontal flex self-stretch justified pad wrap" hidden$="{{!inputTwoShow}}" >
<fc-iss-input class="left" hidden$="{{!inputOneShow}}" class="padded" iss-class="" iss-name="studentFirstName" name="studentLastName" iss-label="Student First Name"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.studentFirstName}}">
    </fc-iss-input> 
    <fc-iss-input class="right" hidden$="{{!inputTwoShow}}" class="padded" iss-name="studentLastName" name="studentLastName" iss-label="Student Last Name"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.studentLastName}}">
    </fc-iss-input>
    </div>
        <div class="layout horizontal flex self-stretch justified pad wrap" hidden$="{{!inputTwoShow}}" >
<fc-iss-input class="left" hidden$="{{!inputOneShow}}" iss-class="" class="padded"  iss-name="gradeLevel" name="gradeLevel" iss-label="Grade Level"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.gradeLevel}}">
    </fc-iss-input> 
    <fc-iss-input class="right" hidden$="{{!inputTwoShow}}" class="padded" iss-name="currentSchool" name="currentSchool" iss-label="Current School"  value-object="{{valueObject}}"  item-select-property=""  select-check="false" dropdown-items="{{callerRoleList.currentSchool}}">
    </fc-iss-input>
    </div>
  <textarea id="mytxxtarea" type="text" contenteditable on-keyup="setValue" style="resize: none; width: 100%; outline: 0px solid; border: solid silver 1px;" hidden$="{{!textareaShow}}" placeholder="Message" maxlength="1000" rows="20" columns="60" value="{{taValue::input}}" class="layout vertical arround-justified">

 </textarea> 

    <paper-listbox  id="myUniversalMenu" class$="[[listType]]" multi="[[isMulti]]" style$="[[_computeStyleByType(listType)]];" attr-for-selected="value">
            <template is="dom-repeat"  items="{{formsDisplay}}" filter="{{_createFilter(taValue, formsDisplay)}}" observe="taValue searchOn value label" id="optionsRepeater" >
                <paper-item hidden$="{{!item}}" class$="[[listType]] horizontal layout flex self-stretch" name="[[item.name]]" selected-checked="{{item.selectedChecked}}" on-tap="makeSelection" attr-for-selected="value" value$="[[item.value]]">  
                    <section class="horizontal layout checkHolder" hidden$="[[_computeHiddenCheck(listType)]]">
                            <section class="checkmark" hidden$="[[!_computeSelectedCheck(item.selectedChecked, mySelected, item.value, listType)]]">
                            âœ…
                            </section>
                            <section hidden$="[[_computeSelectedCheck(item.selectedChecked, mySelected, item.value, listType)]]" class="checkmark" style="font-size: 1.75em;" >
                            [[item.checkbox]]
                            </section>
                            <section class="checkmark" style$="font-size:[[item.fontEm]]em;">
                            [[item.symbol]]
                            </section>
                    </section>
                    <paper-item-body class="layout vertical flex-7">
                        <section class$="label [[listType]]" style$="font-weight:[[computeFontSelected(item.selectedChecked, mySelected, item.value, listType)]];">
                            [[item.label]]
                        </section>
                            <details hidden$="[[computeDetails(listType)]]" open="[[computeOpened(listType)]]">
                                <summary hidden$="[[summHidden]]">Show Details</summary>
                                <section class$="[[listType]]" style$="font-weight:[[computeFontSelected(item.selectedChecked, mySelected, item.value, listType)]]">[[item.text]]</section>
                            </details>
                    </paper-item-body>       
                </paper-item>
        </template>
    </paper-listbox>      
    </template>  
 <script>
 FcCheckMenu=Polymer({
    is:"fc-check-menu",
    behaviors: [FCBehaviors.FocusedDataManagerBehavior],
    properties:{

         checkedEvent:{
            type: Object,
            value: function(){return {};},
            notify: true,

        },
        callerRoleList:{
            type: Object,
            value: null,
            notify: true,
            observer: "observeCallerRoleArray",
        },
        hideListbox:{
            type: Boolean,
            value: function(){return false;},
            notify: true,
        },
        shadowIndex:{type: Number, notify: true,},
        formName:{
            type: String, 
            notify: true
        },
          formsDisplay:{
            type: Array,
            value: function(){return [];},
            notify: true,
        },
        heldValue:{
            type: String, 
            value: function(){return null;},
            notify: true,
        },
        inputOneShow:{type: Boolean, value: function(){return false;},computed: "_computedShow(shadowIndex)", notify: true},
        inputTwoShow:{type: Boolean, value: function(){return false;}, computed: "_computedShow(shadowIndex)", notify: true},
        isMulti:{
            type: Boolean,
            value: function(){return false;},
            notify: true,
        },
         isNotToggle:{
            type:Boolean, 
            value:function(){return false;},
            notify: true,
        },
         listType: {
            type: String, 
            value: function(){return "surveyPage";},
            notify: true, 
        }, 
        model:{
            type: Object,
            value: function(){return {};},
            notify: true,

        },
        selected:{
            type: Array,
            notify: true, 
        },
         mySelected:{
            type: String,
            value: function(){return "";},
            notify: true,
        },
        symbols:{
            type:Array,
            value: function(){return ['\âž”','\â¶','\âœ‚','\âœŽ','\âœ’','\âœœ','\âš','\â¶','\âž€','\âžž','\â˜š','\â˜›','\â˜°','\â˜±','\â˜·','\â˜‘','\â˜','\â˜Ž','\â˜','\â–º','\â–¼','\â–²','\â—„','\â‡’','\Î”','\â–','\â–ˆ','\â–„','\â–€','\â›”','\ðŸŒ','\ðŸŒŽ','\ðŸŒŽ','\ðŸŒ','\ðŸŒ','\â“','\â—','\âŒ','\â©','\âª','\â«','\â¬','\â­','\â®','\â¯','\âœ…','\âŽ','\âœ','\âœ‰','\âœŠ','\âœ‹','\âœŒ','\â¬›','\â¬œ','\îˆ³','\ðŸ•','\â°','\â±','\â²','\â³','\âš™', '\ðŸ•°','\â‡¦','\â‡§','\â‡¨','\â‡©','\â','\ðŸ”˜','\ðŸ”™', '\ðŸ”œ', '/ðŸ”—', '\ðŸ””','\ðŸ”•','\ðŸ”‘','\ðŸ”','\ðŸ”', '\ðŸ”Ž', '\ðŸ”','\ðŸ”Š','\ðŸ”‰','\ðŸ”ˆ','\ðŸ”‡', '\ðŸ”„', '\ðŸ“°','\ðŸ“‘','\ðŸ“”','\ðŸ“–','\ðŸ“Ž','\ðŸ“Ž','\ðŸ“','\ðŸ“Œ','\ðŸ“‹','\ðŸ“Š','\ðŸ“‰','\ðŸ“ˆ','\ðŸ“„','\ðŸ“ƒ','\ðŸ“‚','\ðŸ“','\ðŸ“¥','\ðŸ“¤','\ðŸ“ž','\ðŸ“','\ðŸ“™','\ðŸ“§','\ðŸ“¨','\ðŸ“©','\ðŸ“®','\ðŸ“²','\ðŸ“´','\ðŸ“µ','\ðŸ“¶','\ðŸ”´','\ðŸ”µ','\ðŸ”·','\ðŸ”¶','\ðŸ”¸','\ðŸ”¹','\ðŸ™ˆ','\ðŸ™‰','\ðŸ™Š','\â•¦','\â•”', '\â¦',];
            },
            notify: true,
        },
        // selectedChecked:{
        //     type: Boolean,
        //     value: function(){return false;},
        //     notify: true
        // },
       
        selectedIndexArchive:{
            type: Array,
            value:function(){return [];},
            notify:true,
        },
      
        selectedName:{
            type: String, 
            value: function(){"";},
            notify: true
        },

        summHidden:{  type:Boolean, 
            value:function(){return false;},
            notify: true,
        },
         textareaShow:{
            type: Boolean, 
            value: function(){return false;}, 
            computed: "_computedShow(shadowIndex)",
            notify: true,
        },
         valueObject:{
            type: Object, 
            value: function(){return {};},
            observer:"observeValueObject",
            notify: true
        },
         profilesArray:{
             type: Array,
             value: function(){return [];},
             notify: true
         },
         searchOn:{
            type: Boolean,
            value: function(){return false;},
            notify: true
         },
         itemSelectProperty:{
            type: String,
            value: "label",
            notify: true

         },
         taValue:{
            type: String,
            notify: true,
            observer: "observeTaValue",


         },

      
    },
    ready(){},

     setValue(e){
            console.log(e, e.target.value, "here");
            var input=this.$.mytxxtarea;
          this.set([input,"value"], e.target.value);
          this.$.mytxxtarea.value=e.target.value;
          console.log(this.$.mytxxtarea.value);
          console.log(this.taValue, "tavalue1");
          this.set("taValue", this.$.mytxxtarea.value);
            console.log(this.taValue);     

            },

    _computedShow(shadowIndex){
        if(shadowIndex===3){return true;} else{ return false;}
    },

    attatached(){
         
        console.log("i am in the attached", this.valueObject);
    
    },
    observeCallerRoleArray(newval, oldval){
            if(newval!==null){
              
              this.async(function(){
                                    
                                    this.set("searchOn", true);
                                    this.set("listType", "surveyPage");
                                    var inputs=Polymer.dom(this.root).querySelectorAll("fc-iss-input");
                                    console.log(inputs);
                                    inputs.forEach((elem)=>{
                                                var usefulArray=elem+".dropdownItems";
                                            this.set(usefulArray,this.callerRoleList[elem.name]);
                                        console.log(usefulArray);

                                    });

                                    
            }, 700);
              

            }



    },
    observeTaValue(nv, ov){
        if(nv&&nv!=undefined){console.log(nv,ov);}


    },


    get listbox(){return this.$.myUniversalMenu;},
  
    getDropdownChildren(type){
            var children=Polymer.dom(this.listbox).children;
            var itemChildren=children.filter((val,index,array)=>{return (val.nodeName===type); });
                return itemChildren;
    },

_createFilter: function(taValue){
    console.log("hello", taValue, "fuck thus");
    console.log(item, "tard");
    // if(searchOn===false){return function(item){return false;}}
    // else{console.log(item, item, "here item");
        var regex = new RegExp('.*' + taValue + '.*', 'i');
        return function(item){return item.label.match(regex);};
       // if(item.value){return item.value.match(regex);}
          // else{return false;}
        // };
      // }
  },


    //        this.set("changeEvent",{"event": e, "model": e._templateInstance, "value": e.target.value, "target":e.target, "name":e.target.name});
       
    // this.fire("valueObjectEvent", {changeEvent: this.changeEvent});


    //  getProfiles(){
    //     var profiles=this.focusedManager.dashboardMap.get("profiles");
    //     var arrayProfiles= profiles.gridArray[15];
    //     var profileObjectsArr=arrayProfiles.map((pro, i, array)=>{         
    //     console.log(pro.valueObject);    
    //               return pro.valueObject;
    //             });
    //     this.set("profilesArray",  profileObjectsArr);
    //     console.log(this.profilesArray);
    //     return this.profilesArray;
    //         },
    // searchInputProfiles(profiles, property, input){
    //               var regex = new RegExp('.*' + input + '.*', 'i');
    //        var filteredProfiles =this.profiles.filter((obj, i, arr)=>{
    //              if((obj[property].match(regex))!=null){
    //                 return obj;}});
    //        return filteredProfiles;
    //         },
    computeFontSelected(sc, myselected, value, listType){
        
                if(this.heldValue===value||myselected!==value){return "300";}
                if(myselected===value){return "600";}
               
            
        },
    _computeStyleByType(listType){
            var styleType={
                dropdown:"border: silver 1px solid; max-width: 220px; min-width: 220px; background: white; color:#009; max-height: 320px; overflow-y: scroll;",
                surveyPage:"",
            };
            return styleType[listType];
    },
    
    _computeSelectedCheck(sc, myselected, value, listType){
        if(myselected!==value||this.heldValue===value){return false;}//toggle
        if(myselected===value){return true;}
    },
    
    makeSelection(e){ 
        var children = this.getDropdownChildren("PAPER-ITEM");
        if(children&&children.length>0)
        {
            var nodes=children.length-1;
        }
        var model=e.model;
        this.set("model",model);
        this.set("selectedName", e.model.item.name);
        var valObjProp= "valueObject." + e.model.item.name;
        this.listbox.select(model.item.value);
        this.set("mySelected", e.model.item.value);
      //  this.set("valueObject.currentForm",this.formName);
        this.set(valObjProp, this.model.item.value);
        this.model.set("item.selectedChecked",!this.model.item.selectedChecked);
       
        var d=new Date().getTime();
      
        var vals;
        if(this.heldValue!=null&&e.model.item.value===this.heldValue){
            vals="--";
        }
        else{vals=e.model.item.value;}
       
        var entry={index: e.model.index, name:e.model.item.name, value: vals, fcIndex: e.model.item.ind, timestamp: d, user: this.focusedManager.fcid,formName: this.formName};
        this.push("selectedIndexArchive",entry);
       var archive= "focusedManager.archive";
        this.push(archive, entry);
        this.set("checkedEvent", e);
        var last=this.selectedIndexArchive.length-1;
        this.set("heldValue", this.selectedIndexArchive[last].value);
        console.log(this.selectedIndexArchive);
    
      
  },
  _computeHiddenCheck(listType){
    if(listType&&listType==="dropdown"){return true;}
    else{return false;}
  },
  observeValueObject(newVal, oldValue)
  {
    if(newVal)
         {
         console.log("newValue: ", newVal, "and oldManHouse: ", oldValue);
        }     
 
  },

    removeValueFromPropertyStringArrayAndObject(e){console.log("will do something cool here", e, e._templateInstance, e.target, e.target.left, etc);},
            
    computeDetails(listType){return(listType==="dropdown");},

    computeOpened(listType){
        if(listType=="surveyPage"){ this.async(function(){this.set("summHidden", true);}, 180); return true;}
        if(listType==="tools"){    return true;}
        return false;
    },

   




//cut and paste relics... from calendar creator... this drawer now functions as a resizing, right left drawer to hold checkbox or button lists, searchable inputs with drop downs, toggle buttons, the text inputs are animated can hold lists (arrays but presented as comma separated lists, arrays, or just plain strings)

/*the list itself, once fully completed should be instantiated once on teh top level page with the largest scorp... that single page should then be repeatedly stamped and removed from the dom to facillirtate all dropdowns, single page forms, check boxes etc, which can brought up and removed as needed anywhjere on screen.  

first test of this instantiation came in form of the conetxt menu... created this menu then as a add on to a leaned down iss, and to facilitate forms...

not sure on how to integratye text area...  would just replace input in the iss with text are, but the "no close context on the input" allows for the communication, css animation that would other wise have neeen more 
complex as a result of closure (Read I would hjave no idea how to get so much out of so little if enclosed.*/

//TODO: FIX DATA SHADOW--try routing to the page and remove the array button wheel pushe//

 });
 </script>
 </dom-module> 

 <!--

 .checkMinus.dropdown{
        color: brown;
        font-size: 1.6em;
        cursor: pointer;
        margin-right: -12px;
        margin-left: 0px;
        padding-left: 0px;
    }
    .check{
  
        font-size: 9px;
        cursor: pointer;
    }

    .check.surveyPage{

        font-size: 1em;  
    }
    .check.dropdown{
        font-size: 9px
    }
    .checkMinus{
        color: brown;
        font-size: 2.2em;
        cursor: pointer;

    }
     //if(newVal.callerType!="newCaller" || newVal.callerType.matches("ServiceSeeking")!=null)
    //     {
    //         var profiles=  this.getProfiles();
    //         console.log(profiles);
    //         if(newVal.callerRole&&newVal.callerRole!="-"&&newVal.callerRole.match("nonServiceSeeker"!=null)
    //         {
    //         //searchInputProfiles(this.profilesArray, newVal.callerRole, "input");
    //         }        
        
    //     } 
    //   }   